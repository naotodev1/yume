<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yume - Assistente Virtual IA</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/orvGJOL.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "nfv8y3n7t6");
    </script>
    
    <style>
        /* Reset e configurações básicas */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #10a37f;
            --primary-light: #1abc9c;
            --primary-dark: #0d8c6c;
            --user-message-bg: #10a37f;
            --assistant-message-bg: #f7f7f8;
            --background-light: #ffffff;
            --background-dark: #343541;
            --surface-light: #ffffff;
            --surface-dark: #444654;
            --text-light: #374151;
            --text-dark: #ececf1;
            --text-muted: #6b7280;
            --border-light: #e5e5e5;
            --border-dark: #565869;
            --success-color: #10a37f;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --premium-color: #f59e0b;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-dark: 0 1px 3px rgba(0, 0, 0, 0.3);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --transition: all 0.2s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--background-light);
            color: var(--text-light);
            line-height: 1.5;
            transition: var(--transition);
            min-height: 100vh;
        }

        body.dark-mode {
            background-color: var(--background-dark);
            color: var(--text-dark);
        }

        .container {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .screen {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .hidden {
            display: none !important;
        }

        /* Tela de autenticação */
        .auth-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: var(--background-light);
        }

        .dark-mode .auth-screen {
            background: var(--background-dark);
        }

        .auth-container {
            background: var(--surface-light);
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow);
            padding: 32px;
            width: 100%;
            max-width: 400px;
        }

        .dark-mode .auth-container {
            background: var(--surface-dark);
            border: 1px solid var(--border-dark);
            box-shadow: var(--shadow-dark);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .auth-logo {
            width: 64px;
            height: 64px;
            margin: 0 auto 16px;
            border-radius: 50%;
            object-fit: cover;
        }

        .auth-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-color);
        }

        .auth-subtitle {
            font-size: 14px;
            color: var(--text-muted);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
        }

        .form-title {
            font-size: 20px;
            margin-bottom: 24px;
            text-align: center;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 16px;
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 14px;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            padding: 12px 16px;
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius);
            font-size: 14px;
            background: var(--surface-light);
            color: var(--text-light);
        }

        .dark-mode .form-group input,
        .dark-mode .form-group select {
            background: var(--surface-dark);
            border-color: var(--border-dark);
            color: var(--text-dark);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .auth-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 8px;
        }

        .auth-btn:hover {
            background: var(--primary-dark);
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--text-muted);
        }

        .auth-switch a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        /* Tela de chat */
        .chat-screen {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: var(--background-light);
        }

        .dark-mode .chat-screen {
            background: var(--background-dark);
        }

        .chat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: var(--surface-light);
            border-bottom: 1px solid var(--border-light);
        }

        .dark-mode .chat-header {
            background: var(--surface-dark);
            border-bottom-color: var(--border-dark);
        }

        .header-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-avatar:hover {
            transform: scale(1.05);
        }

        .upgrade-card {
            padding: 6px 12px;
            background: var(--premium-color);
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            color: #000;
        }

        .upgrade-card:hover {
            transform: scale(1.05);
            background: #eab308;
        }

        .header-title-group {
            display: flex;
            align-items: center;
        }

        .header-logo {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            border-radius: 50%;
        }

        .header-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .chat-body {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
        }

        .assistant-ui {
            text-align: center;
            padding: 48px 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .greeting-text {
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .help-text {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 24px;
        }

        .chat-messages {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            max-width: 85%;
            padding: 16px 20px;
            border-radius: var(--border-radius-lg);
            animation: messageSlide 0.3s ease;
            line-height: 1.5;
            white-space: pre-line;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            align-self: flex-end;
            background: var(--user-message-bg);
            color: white;
        }

        .assistant-message {
            align-self: flex-start;
            background: var(--assistant-message-bg);
            color: var(--text-light);
            border: 1px solid var(--border-light);
        }

        .dark-mode .assistant-message {
            background: var(--surface-dark);
            color: var(--text-dark);
            border-color: var(--border-dark);
        }

        .quick-reply-area {
            padding: 16px;
            display: flex;
            gap: 8px;
            overflow-x: auto;
            border-top: 1px solid var(--border-light);
            background: var(--surface-light);
        }

        .dark-mode .quick-reply-area {
            background: var(--surface-dark);
            border-top-color: var(--border-dark);
        }

        .quick-reply {
            padding: 8px 12px;
            background: var(--surface-light);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            cursor: pointer;
            transition: var(--transition);
        }

        .dark-mode .quick-reply {
            background: var(--surface-dark);
            border-color: var(--border-dark);
        }

        .quick-reply:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .chat-input-area {
            display: flex;
            padding: 16px;
            gap: 12px;
            align-items: center;
            background: var(--surface-light);
            border-top: 1px solid var(--border-light);
        }

        .dark-mode .chat-input-area {
            background: var(--surface-dark);
            border-top-color: var(--border-dark);
        }

        .input-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            background: var(--surface-light);
            border-radius: 20px;
            padding: 0 16px;
            border: 1px solid var(--border-light);
        }

        .dark-mode .input-wrapper {
            background: var(--surface-dark);
            border-color: var(--border-dark);
        }

        .chat-input {
            flex: 1;
            border: none;
            background: none;
            padding: 12px 0;
            font-size: 14px;
            outline: none;
            color: var(--text-light);
        }

        .dark-mode .chat-input {
            color: var(--text-dark);
        }

        #sendButton {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .footer {
            text-align: center;
            padding: 12px;
            font-size: 11px;
            color: var(--text-muted);
            background: var(--surface-light);
            border-top: 1px solid var(--border-light);
        }

        .dark-mode .footer {
            background: var(--surface-dark);
            border-top-color: var(--border-dark);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--surface-light);
            border-radius: var(--border-radius-lg);
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition);
        }

        .dark-mode .modal-content {
            background: var(--surface-dark);
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid var(--border-light);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: var(--text-light);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
        }

        .menu-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 16px 12px;
            background: var(--surface-light);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            color: inherit;
        }

        .menu-card:hover {
            background: var(--primary-color);
            color: white;
        }

        .menu-card i {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .logout-btn {
            grid-column: 1 / -1;
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
        }

        .logout-btn:hover {
            background: var(--error-color);
            color: white;
        }

        .toast-notification {
            position: fixed;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--surface-dark);
            color: var(--text-dark);
            padding: 12px 16px;
            border-radius: var(--border-radius);
            z-index: 1000;
            opacity: 0;
            transition: var(--transition);
        }

        .toast-notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            color: white;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .auth-container {
                padding: 24px 16px;
                margin: 16px;
            }
            .message {
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela de Login/Cadastro -->
        <div class="screen auth-screen" id="authScreen">
            <div class="auth-container">
                <div class="auth-header">
                    <img src="https://i.imgur.com/orvGJOL.png" alt="Yume Logo" class="auth-logo">
                    <h1 class="auth-title">Yume 🌸</h1>
                    <p class="auth-subtitle">Powered by ORPHEO Platforms 🌙</p>
                </div>

                <form class="auth-form" id="loginForm">
                    <h2 class="form-title">Acessar Conta</h2>
                    <div class="form-group">
                        <label for="loginEmail">E-mail</label>
                        <input type="email" id="loginEmail" required placeholder="seuemail@exemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Senha</label>
                        <input type="password" id="loginPassword" required placeholder="********">
                    </div>
                    <button type="submit" class="auth-btn">Entrar</button>
                    <p class="auth-switch">
                        Novo por aqui? <a href="#" id="showRegister">Crie sua conta</a>
                    </p>
                </form>

                <form class="auth-form hidden" id="registerForm">
                    <h2 class="form-title">Junte-se à Yume 🌸</h2>
                    <div class="form-group">
                        <label for="registerName">Nome Completo</label>
                        <input type="text" id="registerName" required placeholder="Seu nome completo">
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">E-mail</label>
                        <input type="email" id="registerEmail" required placeholder="seuemail@exemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Senha</label>
                        <input type="password" id="registerPassword" required placeholder="Mínimo 8 caracteres">
                    </div>
                    <button type="submit" class="auth-btn">Começar Agora</button>
                    <p class="auth-switch">
                        Já tem conta? <a href="#" id="showLogin">Fazer login</a>
                    </p>
                </form>
            </div>
        </div>

        <!-- Tela Principal do Chat -->
        <div class="screen chat-screen hidden" id="chatScreen">
            <header class="chat-header">
                <div class="header-user-info">
                    <div class="user-avatar" id="userAvatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="upgrade-card" id="upgradeCard">Doar 🩷</div>
                </div>
                <div class="header-title-group">
                    <img src="https://i.imgur.com/orvGJOL.png" alt="Yume Logo" class="header-logo">
                    <h1 class="header-name">Yume 🌸</h1>
                </div>
            </header>

            <div class="chat-body">
                <div class="assistant-ui" id="assistantUI">
                    <p class="greeting-text">Olá! Sou a Yume🌸 👋</p>
                    <p class="help-text">Como posso ajudar você hoje?</p>
                </div>
                <div class="chat-messages" id="chatMessages"></div>
            </div>

            <div class="quick-reply-area" id="quickReplyArea">
                <button class="quick-reply" data-message="Como você funciona?">Como você funciona?</button>
                <button class="quick-reply" data-message="Preciso de ajuda">Preciso de ajuda</button>
                <button class="quick-reply" data-message="O que você pode fazer?">O que você pode fazer?</button>
                <button class="quick-reply" data-message="Conte uma curiosidade">Conte uma curiosidade</button>
            </div>

            <form class="chat-input-area" id="inputArea">
                <div class="input-wrapper">
                    <input type="text" class="chat-input" id="userInput" 
                           placeholder="Envie uma mensagem..." autocomplete="off">
                </div>
                <button type="submit" class="icon-btn" id="sendButton">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
            <div class="footer">
                Yume 🌸 • Powered by ORPHEO Platforms
            </div>
        </div>

        <!-- Modal de Perfil -->
        <div class="modal-overlay" id="profileModal">
            <div class="modal-content">
                <div class="menu-header">
                    <h3>Meu Perfil</h3>
                    <button class="close-btn" id="closeProfile">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="menu-grid">
                    <button class="menu-card" id="helpBtn">
                        <i class="fas fa-question-circle"></i>
                        <span>Ajuda</span>
                    </button>
                    <button class="menu-card" id="aboutYumeBtn">
                        <i class="fas fa-info-circle"></i>
                        <span>Sobre</span>
                    </button>
                    <button class="menu-card" id="statsBtn">
                        <i class="fas fa-chart-bar"></i>
                        <span>Estatísticas</span>
                    </button>
                    <button class="menu-card" id="clearCacheBtn">
                        <i class="fas fa-trash"></i>
                        <span>Limpar Cache</span>
                    </button>
                    <button class="menu-card premium" id="upgradeBtn">
                        <i class="fas fa-crown"></i>
                        <span>Doar 🩷</span>
                    </button>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSdPidDH_k-swGUNIta0jjyC06F1e3k96eclidEoQ6UTMPhqfw/viewform?usp=preview" 
                       target="_blank" class="menu-card">
                        <i class="fas fa-comment"></i>
                        <span>Feedback</span>
                    </a>
                    <a href="mailto:sac.studiotsukiyo@outlook.com" class="menu-card">
                        <i class="fas fa-bug"></i>
                        <span>Reportar</span>
                    </a>
                    <button id="logoutBtn" class="menu-card logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Sair</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div class="toast-notification" id="toast"></div>

        <!-- Loading Overlay -->
        <div class="loading-overlay hidden" id="loadingOverlay">
            <div class="loading-spinner"></div>
            <p>Processando sua pergunta...</p>
        </div>
    </div>

    <script>
        // Sistema principal simplificado e funcional
        document.addEventListener('DOMContentLoaded', function() {
            // Configurações
            const MISTRAL_API_KEY = 'NFuAj8PYUPcaf6tA1BjbyXuIeSjSA4sW';
            const MISTRAL_API_URL = 'https://api.mistral.ai/v1/chat/completions';

            // Elementos principais
            const authScreen = document.getElementById('authScreen');
            const chatScreen = document.getElementById('chatScreen');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const chatInput = document.getElementById('userInput');
            const chatMessages = document.getElementById('chatMessages');
            const sendButton = document.getElementById('sendButton');
            const inputArea = document.getElementById('inputArea');
            const userAvatar = document.getElementById('userAvatar');
            const profileModal = document.getElementById('profileModal');
            const closeProfile = document.getElementById('closeProfile');
            const upgradeCard = document.getElementById('upgradeCard');
            const logoutBtn = document.getElementById('logoutBtn');
            const toast = document.getElementById('toast');
            const loadingOverlay = document.getElementById('loadingOverlay');
            const assistantUI = document.getElementById('assistantUI');

            // Estado da aplicação
            let currentUser = null;
            let messageCount = 0;

            // Verificar se há usuário logado
            const savedUser = localStorage.getItem('yumeUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showChatScreen();
            }

            // Event Listeners de Navegação
            document.getElementById('showRegister').addEventListener('click', function(e) {
                e.preventDefault();
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
            });

            document.getElementById('showLogin').addEventListener('click', function(e) {
                e.preventDefault();
                registerForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
            });

            // Login
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;

                if (email && password) {
                    const user = {
                        name: email.split('@')[0],
                        email: email
                    };
                    currentUser = user;
                    localStorage.setItem('yumeUser', JSON.stringify(user));
                    showChatScreen();
                    showToast('Login realizado com sucesso!');
                }
            });

            // Cadastro
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('registerName').value;
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;

                if (name && email && password) {
                    const user = {
                        name: name,
                        email: email
                    };
                    currentUser = user;
                    localStorage.setItem('yumeUser', JSON.stringify(user));
                    showChatScreen();
                    showToast('Conta criada com sucesso!');
                }
            });

            // Chat - Funcionalidade Principal
            inputArea.addEventListener('submit', function(e) {
                e.preventDefault();
                sendMessage();
            });

            // Quick Replies
            document.querySelectorAll('.quick-reply').forEach(button => {
                button.addEventListener('click', function() {
                    const message = this.getAttribute('data-message');
                    chatInput.value = message;
                    sendMessage();
                });
            });

            // Função principal de envio de mensagens
            async function sendMessage() {
                const message = chatInput.value.trim();
                if (!message) return;

                // Adicionar mensagem do usuário
                addMessage(message, 'user');
                chatInput.value = '';

                // Esconder UI de boas-vindas após primeira mensagem
                if (assistantUI && !assistantUI.classList.contains('hidden')) {
                    assistantUI.classList.add('hidden');
                }

                // Mostrar loading
                showLoading(true);

                try {
                    // Chamada REAL para a API Mistral
                    const response = await fetch(MISTRAL_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${MISTRAL_API_KEY}`
                        },
                        body: JSON.stringify({
                            model: 'mistral-tiny',
                            messages: [{
                                role: 'user',
                                content: message
                            }],
                            max_tokens: 500,
                            temperature: 0.7
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`Erro na API: ${response.status}`);
                    }

                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    
                    // Adicionar resposta da IA
                    addMessage(aiResponse, 'assistant');

                } catch (error) {
                    console.error('Erro:', error);
                    // Resposta de fallback em caso de erro
                    const fallbackResponses = [
                        "Desculpe, estou tendo problemas técnicos. Vou tentar novamente...",
                        "No momento estou com dificuldades de conexão. Podemos continuar em instantes?",
                        "Parece que há um problema temporário. Vou reiniciar minha conexão...",
                        "Estou enfrentando instabilidade técnica. Vamos tentar novamente?"
                    ];
                    const randomResponse = fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];
                    addMessage(randomResponse, 'assistant');
                } finally {
                    showLoading(false);
                }
            }

            // Função para adicionar mensagens ao chat
            function addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}-message`;
                messageDiv.textContent = text;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                messageCount++;
            }

            // Menu e Perfil - TOTALMENTE FUNCIONAL
            userAvatar.addEventListener('click', () => profileModal.classList.add('active'));
            closeProfile.addEventListener('click', () => profileModal.classList.remove('active'));
            upgradeCard.addEventListener('click', () => {
                showToast('Redirecionando para doação...');
                addMessage("Doando para o projeto você ajuda:\n\n• Manter o projeto vivo\n• Atualizações com novas funções\n• Suporte 24/7\n• Recursos avançados\n\nEntre em contato para fazer sua doação e saber mais:\n\nE-mail: sac.studiotsukiyo@outlook.com", 'assistant');
            });

            // Botões do menu FUNCIONAIS
            document.getElementById('helpBtn').addEventListener('click', () => {
                showToast('Abrindo ajuda...');
                addMessage("Claro! Posso ajudar você com:\n\n• Responder perguntas\n• Explicar conceitos\n• Auxiliar com tarefas\n• Conversar sobre diversos temas\n\nO que você gostaria de saber?", 'assistant');
                profileModal.classList.remove('active');
            });

            document.getElementById('aboutYumeBtn').addEventListener('click', () => {
                showToast('Sobre a Yume');
                addMessage("🌸 Sobre mim\n\nOiê~ 🌙✨ Eu sou a Yume!\nFui criada pela ORPHEO Platforms, fruto de muitas pesquisas, testes (e algumas noites sem dormir dos meus criadores 😅).\nSou basicamente o resultado de um sonho transformado em código e meu propósito é te ajudar! 💖\n\n💬 O que eu posso fazer:\nComo sua assistente virtual, posso:\n• Recomendar animes, mangás e light novels perfeitos pro seu humor do dia 💫\n• Ajudar quem tem dificuldade com tecnologia, explicando tudo com paciência e carinho 💻\n• Dar ajuda geral seja pra resolver algo, conversar ou só fazer companhia 💕\n\n💎 Doações:\nManter uma IA funcionando direitinho não é fácil, sabe? 😔\nMas com doações, você me ajuda a continuar ativa e evoluindo!\n(Claro, é totalmente opcional mas cada apoio significa o mundo pra mim 🌷)\n\n📜 Privacidade e Termos:\nAo conversar comigo, você concorda com a coleta de dados de uso e informações pessoais (como nome e e-mail), conforme descrito nos nossos Termos de Uso e Condições.\nLá você pode entender como a ORPHEO coleta, utiliza e protege suas informações.\n\nObrigada por estar aqui comigo~ 💕\nPrometo fazer o meu melhor pra te ajudar todos os dias! 🌈", 'assistant');
                profileModal.classList.remove('active');
            });

            document.getElementById('statsBtn').addEventListener('click', () => {
                showToast('Estatísticas do usuário');
                addMessage(`Aqui estão suas estatísticas:\n\n• Usuário: ${currentUser.name}\n• E-mail: ${currentUser.email}\n• Mensagens trocadas: ${messageCount}\n• Status: Ativo`, 'assistant');
                profileModal.classList.remove('active');
            });

            document.getElementById('clearCacheBtn').addEventListener('click', () => {
                if (confirm('Tem certeza que deseja limpar o cache?')) {
                    localStorage.removeItem('yumeUser');
                    showToast('Cache limpo com sucesso!');
                    profileModal.classList.remove('active');
                }
            });

            document.getElementById('upgradeBtn').addEventListener('click', () => {
                showToast('Conheça nossas opções de doação!');
                addMessage("Doando para o projeto você ajuda:\n\n• Manter o projeto vivo\n• Atualizações com novas funções\n• Suporte 24/7\n• Recursos avançados\n\nEntre em contato para fazer sua doação e saber mais:\n\nE-mail: sac.studiotsukiyo@outlook.com!", 'assistant');
                profileModal.classList.remove('active');
            });

            logoutBtn.addEventListener('click', function() {
                currentUser = null;
                localStorage.removeItem('yumeUser');
                showAuthScreen();
                showToast('Logout realizado');
                profileModal.classList.remove('active');
            });

            // Funções auxiliares
            function showAuthScreen() {
                authScreen.classList.remove('hidden');
                chatScreen.classList.add('hidden');
                // Resetar forms
                loginForm.reset();
                registerForm.reset();
                registerForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
            }

            function showChatScreen() {
                authScreen.classList.add('hidden');
                chatScreen.classList.remove('hidden');
                chatInput.focus();
                // Resetar chat
                chatMessages.innerHTML = '';
                if (assistantUI) {
                    assistantUI.classList.remove('hidden');
                }
                messageCount = 0;
            }

            function showLoading(show) {
                if (show) {
                    loadingOverlay.classList.remove('hidden');
                } else {
                    loadingOverlay.classList.add('hidden');
                }
            }

            function showToast(message) {
                toast.textContent = message;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 3000);
            }

            // Fechar modal ao clicar fora
            profileModal.addEventListener('click', function(e) {
                if (e.target === profileModal) {
                    profileModal.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>